# 书库筛选选项使用说明

## 功能概述

书库侧边栏现在提供了四个筛选选项，帮助您快速访问不同类别的书籍：

1. **全部书籍** - 显示所有书籍
2. **收藏** - 显示您收藏的书籍
3. **最近阅读** - 显示最近阅读的书籍（最多20本）
4. **分类** - 按分类浏览书籍

## 使用方法

### 1. 打开侧边栏

- 点击左上角的菜单图标（三条横线）
- 或者从屏幕左侧向右滑动

### 2. 选择筛选选项

在侧边栏的"书库"部分，您会看到四个选项：

#### 📚 全部书籍
- 显示您书库中的所有书籍
- 这是默认视图

#### ❤️ 收藏
- 显示您标记为收藏的书籍
- 如何添加收藏：
  1. 长按书籍卡片打开详情
  2. 点击"收藏"按钮
- 如果没有收藏的书籍，会显示提示信息

#### 🕐 最近阅读
- 显示您最近阅读的书籍
- 按最后阅读时间降序排列
- 最多显示20本书籍
- 如果没有阅读记录，会显示提示信息

#### 📂 分类
- 显示所有书籍分类及每个分类的书籍数量
- 点击分类卡片可以查看该分类下的所有书籍
- 分类信息在扫描书籍时自动识别
- 如果没有分类，会显示提示信息

### 3. 浏览分类

1. 点击侧边栏中的"分类"选项
2. 您会看到所有分类的列表，每个分类显示：
   - 分类名称
   - 该分类下的书籍数量
3. 点击任意分类卡片，查看该分类下的所有书籍
4. 使用返回按钮返回分类列表

## 视图切换

在任何筛选视图下，您都可以：

- **切换布局**：使用过滤栏右侧的布局按钮
  - 列表视图：显示详细信息
  - 紧凑网格：大卡片网格
  - 纯封面：只显示封面

- **使用过滤器**：使用过滤栏的快速筛选
  - 全部
  - 最新
  - 阅读中
  - 已读
  - 未读

- **搜索**：点击搜索图标搜索书籍

## 空状态提示

当某个筛选视图没有内容时，会显示友好的提示信息：

- **无收藏书籍**："暂无收藏的书籍 - 点击书籍详情中的收藏按钮来添加收藏"
- **无最近阅读**："暂无最近阅读记录 - 开始阅读书籍后，这里会显示最近阅读的内容"
- **无分类**："暂无分类 - 书籍的分类信息会在扫描时自动识别"
- **分类下无书籍**："该分类下暂无书籍 - 尝试其他分类或返回全部书籍"

## 技术说明

### 路由参数

筛选功能通过URL路由参数实现：

- `library` - 全部书籍
- `library?filter=favorites` - 收藏
- `library?filter=recent` - 最近阅读
- `library?filter=categories` - 分类列表
- `library?filter=categories&category=分类名` - 特定分类的书籍

### 数据持久化

- 收藏状态保存在数据库中
- 最近阅读记录自动更新
- 分类信息在扫描时识别并保存

### 性能优化

- 使用Flow实现响应式数据更新
- 最近阅读列表限制为20本，提高性能
- 分类列表按名称排序
- 使用LazyColumn/LazyVerticalGrid实现列表懒加载

## 常见问题

### Q: 为什么看不到分类？
A: 分类信息需要在扫描书籍时自动识别。如果您的书籍文件没有分类信息，可能不会显示分类。

### Q: 最近阅读为什么只显示20本？
A: 为了保持界面简洁和性能，最近阅读列表限制为20本最近阅读的书籍。

### Q: 如何添加收藏？
A: 长按书籍卡片打开详情底部弹窗，然后点击"收藏"按钮。

### Q: 筛选选项点击后没有反应？
A: 请确保您使用的是最新版本的应用。如果问题持续，请尝试重启应用。

## 更新日志

### v1.0.0 (2024-10-28)
- ✅ 实现收藏筛选功能
- ✅ 实现最近阅读筛选功能
- ✅ 实现分类浏览功能
- ✅ 添加空状态提示
- ✅ 完善错误处理
- ✅ 支持中英文界面
